angular.module("umbraco").directive("iconicIcon",function(){var n=function(n){n.$watch("icon",function(){n.template=n.package.overrideTemplate?n.package.backofficeTemplate.replace("{icon}",n.icon):n.package.template.replace("{icon}",n.icon)})},t=function(n,t){n.$watch("icon",function(){t.html(n.template);t.attr("title",n.icon)})};return{restrict:"E",scope:{icon:"=icon",package:"=package"},controller:n,link:t}});angular.module("umbraco").directive("packageForm",function(){var n=function(n,t,i,r){function f(n){const t={title:"Select file",section:"settings",treeAlias:"files",entityType:"file",filter:function(n){if(n.name.indexOf(".min.css")===-1&&n.name.indexOf(".css")===-1)return!0},filterCssClass:"not-allowed",close:function(){r.close()}};var i=_.assign(t,n);r.treePicker(i)}function u(t){i.localize(t).then(function(t){n.error=t.value})}function e(i,r,f){n.error=null;(!i.selector||i.selector.length<=0)&&(f(),u("iconicErrors_selector"));i.sourcefile||(i.sourcefile=i.cssfile);t.get(i.sourcefile).then(function(n){i.extractedStyles=[];for(var e=new RegExp(i.selector,"g"),t=e.exec(n.data);t!==null;)i.extractedStyles.push(t[1]),t=e.exec(n.data);i.extractedStyles.length>0?r():(u("iconicErrors_no_rules"),f())},function(){u("iconicErrors_loadingCss");f()})}n.submitPackageForm=function(){n.packageForm.$valid&&e(n.package,function(){n.analysing="success";n.onsaved()},function(){n.analysing="error"})};n.openCssFilePicker=function(){const t={select:function(t){const i=unescape(t.id);n.package.cssfile=i;r.close()}};f(t)};n.openRulesFilePicker=function(){const t={select:function(t){const i=unescape(t.id);n.package.sourcefile=i;r.close()}};f(t)};n.removeCssFile=function(){n.package.cssfile=null};n.removeRulesFile=function(){n.package.sourcefile=null}};return{restrict:"E",scope:{package:"=",onsaved:"&",oncancel:"&"},controller:n,templateUrl:"/App_Plugins/Iconic/Views/directives/package-form.html"}});