"use strict";angular.module("umbraco").controller("Koben.Iconic.Prevalues.Packages",["$scope","$http","assetsService","localizationService",function(n,t,i,r){function u(t){r.localize(t).then(function(t){n.data.iconicError=t})}function e(){t.get("/App_Plugins/Iconic/preconfigs.json").success(function(t){n.preconfig=t.preconfigs}).error(function(){u("iconicErrors_loading")})}function f(i,r,f){n.data.iconicError=null;(!i.selector||i.selector.length<=0)&&(f(),u("iconicErrors_selector"));i.sourcefile||(i.sourcefile=i.cssfile);t.get(i.sourcefile).success(function(n){i.extractedStyles=[];for(var e=new RegExp(i.selector,"g"),t=e.exec(n);t!==null;)i.extractedStyles.push(t[1]),t=e.exec(n);i.extractedStyles.length>0?r():(u("iconicErrors_no_rules"),f())}).error(function(){u("iconicErrors_loadingCss");f()})}n.newItem=new Package;n.data={editPackage:!1,analysing:"init",configType:"custom",selectedItem:null,selectedPreConfig:null,showNewItemForm:!1,iconicError:null};angular.isArray(n.model.value)||(n.model.value=[]);n.addNewItem=function(t){t&&(n.data.analysing="busy",f(n.newItem,function(){n.model.value.push(angular.copy(n.newItem));n.newItem=new Package;n.data.showNewItemForm=!1;n.data.analysing="success";n.data.selectedPreConfig=null},function(){n.data.analysing="error"}))};n.submitEditPackage=function(t,i){i&&f(t,function(){n.data.analysing="success";n.data.editPackage=!1},function(){n.data.analysing="error"})};n.selectItem=function(t){n.data.selectedItem=n.data.selectedItem===t?null:t};n.removeItem=function(t){n.model.value.splice(t,1)};n.selectPreConfig=function(t){Object.assign(n.newItem,t)};e()}]);